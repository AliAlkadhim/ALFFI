{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "40Yb47zJQglm"
   },
   "source": [
    "## Simulation-Based Inference SIR Model: Training (critical value)\n",
    "Created: May 23, 2022 Prosper and Prosper<br>\n",
    "Updated: Apr 05, 2023 HBP<br>\n",
    "Updated: Oct 30, 2023 HBP\n",
    "\n",
    "### Introduction \n",
    "\n",
    "The purpose of this notebook is to approximate $\\mathbb{P}(\\lambda \\le \\lambda_0 | \\theta) = \\mathbb{E}(Z | \\theta)$ in two different ways: 1) using a 2D histogram and 2) a neural network, where for a given hypothesis $H_0: \\theta = \\theta_0$ versus $H_1: \\theta \\ne \\theta_0$, $\\lambda_0$ is the observed value of the test statistic $\\lambda$ (see SIR_generate_data.ipynb for details.)\n",
    "\n",
    "Our test statistic $\\lambda$  is large for parameters $\\theta$ *disfavored* by the data, whereas in the algorithm of Ref.[1], a modified version of which we use, $\\lambda$ is small for disfavored parameters. Therefore, we're approximating the cumulative distribution function (cdf) rather than the p-value. \n",
    "\n",
    "The stochastic forward simulator $F_\\theta$ is the CTMC simulator in notebook SIR_generate_data.ipynb, which simulates the ensemble of synthetic epidemics.\n",
    "\n",
    "\n",
    "### Approximating $\\mathbb{P}(\\lambda \\le \\lambda_0 | \\theta) = \\mathbb{E}(Z | \\theta)$ by histogramming\n",
    "\n",
    "The quantity $\\mathbb{E}(Z | \\theta)$ can be approximated using the following algorithm, which therefore provides a way to check the quality of the deep neural network model.\n",
    "\n",
    "$\\theta = \\alpha, \\beta$\n",
    "\n",
    "  1. Create histogram $h_w \\gets \\text{histogram}(\\alpha, \\beta, \\text{weight}=Z)$\n",
    "  1. Create histogram $h_u \\gets \\text{histogram}(\\alpha, \\beta, \\text{weight}=1)$\n",
    "  1. Approximate $\\mathbb{P}(\\lambda \\le \\lambda_0 | \\alpha, \\beta)$ by $h_w \\, / \\, h_u$\n",
    "\n",
    "### References\n",
    "  1. Anne Lee *et al.*, https://arxiv.org/abs/2107.03920"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "id": "FA1Y5VCv20XZ"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "device: cuda\n"
     ]
    }
   ],
   "source": [
    "import os, sys\n",
    "\n",
    "sys.path.append('../')\n",
    "\n",
    "# the standard module for tabular data\n",
    "import pandas as pd\n",
    "\n",
    "# the standard module for array manipulation\n",
    "import numpy as np\n",
    "\n",
    "# the standard modules for high-quality plots\n",
    "import matplotlib as mp\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# standard scientific python module\n",
    "import scipy as sp\n",
    "import scipy.stats as st\n",
    "import scipy.optimize as op\n",
    "\n",
    "# module to save results\n",
    "#import joblib as jb\n",
    "\n",
    "# pytorch\n",
    "import torch\n",
    "import torch.nn as nn\n",
    "\n",
    "# split data into a training set and a test set\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "# to reload modules\n",
    "import importlib\n",
    "\n",
    "import SIR_dnn_util as ut\n",
    "from SIR_gen_util import Fsolve, test_statistic, SIRdata\n",
    "\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# update fonts\n",
    "FONTSIZE = 18\n",
    "font = {'family' : 'serif',\n",
    "        'weight' : 'normal',\n",
    "        'size'   : FONTSIZE}\n",
    "mp.rc('font', **font)\n",
    "\n",
    "# set usetex = False if LaTex is not \n",
    "# available on your system or if the \n",
    "# rendering is too slow\n",
    "mp.rc('text', usetex=True)\n",
    "\n",
    "# set a seed to ensure reproducibility\n",
    "seed = 128\n",
    "rnd  = np.random.RandomState(seed)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "device  = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "device(type='cuda')"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "device"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "NJC916BU-9L6"
   },
   "source": [
    "### Define model $f(\\alpha, \\beta, \\lambda; \\omega)$\n",
    "\n",
    "For simple models, it is sufficient to use the __Sequential__ class."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overwriting ../models/SIR_dnn_quantile.py\n"
     ]
    }
   ],
   "source": [
    "%%writefile ../models/SIR_dnn_quantile.py\n",
    "\n",
    "name     = 'SIR_dnn_quantile'\n",
    "features = ['alpha', 'beta', 'tau']\n",
    "target   = 'lo'\n",
    "nodes    = 25\n",
    "\n",
    "import torch\n",
    "import torch.nn as nn\n",
    "\n",
    "model = nn.Sequential(nn.Linear( len(features), nodes),\n",
    "                      nn.ReLU(),\n",
    "                      \n",
    "                      nn.Linear(nodes, nodes),\n",
    "                      nn.ReLU(),\n",
    "                      \n",
    "                      nn.Linear(nodes, nodes),\n",
    "                      nn.ReLU(), \n",
    "                      \n",
    "                      nn.Linear(nodes, nodes),\n",
    "                      nn.ReLU(),                    \n",
    "                      \n",
    "                      nn.Linear(nodes, nodes),\n",
    "                      nn.ReLU(), \n",
    "                      \n",
    "                      nn.Linear(nodes, nodes),\n",
    "                      nn.ReLU(),                    \n",
    "                      \n",
    "                      nn.Linear(nodes, 1)\n",
    "                     )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SIR_dnn_quantile\n",
      "Sequential(\n",
      "  (0): Linear(in_features=3, out_features=25, bias=True)\n",
      "  (1): ReLU()\n",
      "  (2): Linear(in_features=25, out_features=25, bias=True)\n",
      "  (3): ReLU()\n",
      "  (4): Linear(in_features=25, out_features=25, bias=True)\n",
      "  (5): ReLU()\n",
      "  (6): Linear(in_features=25, out_features=25, bias=True)\n",
      "  (7): ReLU()\n",
      "  (8): Linear(in_features=25, out_features=25, bias=True)\n",
      "  (9): ReLU()\n",
      "  (10): Linear(in_features=25, out_features=25, bias=True)\n",
      "  (11): ReLU()\n",
      "  (12): Linear(in_features=25, out_features=1, bias=True)\n",
      ")\n",
      "number of parameters: 3376\n"
     ]
    }
   ],
   "source": [
    "import models.SIR_dnn_quantile as NN\n",
    "importlib.reload(NN)\n",
    "name     = NN.name\n",
    "model    = NN.model#.to(device)\n",
    "features = NN.features\n",
    "target   = NN.target\n",
    "modelfile  = '%s.dict' % NN.name\n",
    "print(name)\n",
    "print(model)\n",
    "print('number of parameters: %d' % ut.number_of_parameters(model))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Load data\n",
    "\n",
    "__Note__: The $\\alpha$ and $\\beta$ parameters have been scaled so that they are of $\\cal{O}(1)$. Therefore, no further transformation is needed."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SIRdata\n",
      " D           : [  3  25  75 227 296 258 236 192 126  71  28  11   7]\n",
      " I0          : 3\n",
      " O           : [  3  25  75 227 296 258 236 192 126  71  28  11   7]\n",
      " R0          : 0\n",
      " S0          : 763\n",
      " T           : [ 0  2  3  4  5  6  7  8  9 10 11 12 13]\n",
      " alpha0      : 0.465\n",
      " alpha_bins  : 16\n",
      " alpha_max   : 0.9\n",
      " alpha_min   : 0.1\n",
      " alpha_scale : 1.0\n",
      " beta0       : 0.00237\n",
      " beta_bins   : 16\n",
      " beta_max    : 0.65\n",
      " beta_min    : 0.25\n",
      " beta_scale  : 0.005\n",
      " model       : SIR\n",
      " scale       : 50\n",
      " tmax        : 14.0\n",
      " tmin        : 0.0\n",
      "\n",
      "\n",
      "loading ../data/SIR_traindata_100k.csv.gz\n",
      "number of rows: 100000\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>alpha</th>\n",
       "      <th>beta</th>\n",
       "      <th>li</th>\n",
       "      <th>lo</th>\n",
       "      <th>l0</th>\n",
       "      <th>Zo</th>\n",
       "      <th>Z0</th>\n",
       "      <th>i</th>\n",
       "      <th>I</th>\n",
       "      <th>tau</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.556824</td>\n",
       "      <td>0.432547</td>\n",
       "      <td>0.017546</td>\n",
       "      <td>0.455190</td>\n",
       "      <td>0.068463</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>[3, 13, 65, 134, 222, 229, 200, 153, 99, 69, 4...</td>\n",
       "      <td>[3.0, 25.41, 66.24, 140.76, 212.17, 226.2, 190...</td>\n",
       "      <td>0.234051</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.917183</td>\n",
       "      <td>0.617733</td>\n",
       "      <td>0.110494</td>\n",
       "      <td>0.172180</td>\n",
       "      <td>0.323215</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>[3, 3, 27, 71, 151, 170, 106, 63, 42, 20, 8, 4...</td>\n",
       "      <td>[3.0, 46.43, 126.68, 188.65, 160.33, 101.22, 5...</td>\n",
       "      <td>0.403957</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.222595</td>\n",
       "      <td>0.684092</td>\n",
       "      <td>0.020499</td>\n",
       "      <td>0.309478</td>\n",
       "      <td>0.178384</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>[3, 286, 527, 507, 413, 337, 273, 222, 172, 14...</td>\n",
       "      <td>[3.0, 232.07, 521.39, 511.27, 423.76, 341.88, ...</td>\n",
       "      <td>0.231190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.513685</td>\n",
       "      <td>0.231400</td>\n",
       "      <td>0.054771</td>\n",
       "      <td>1.783674</td>\n",
       "      <td>0.630670</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>[3, 4, 6, 2, 5, 8, 7, 13, 29, 44, 50, 67, 85]</td>\n",
       "      <td>[3.0, 6.22, 8.89, 12.59, 17.59, 24.14, 32.47, ...</td>\n",
       "      <td>0.489115</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.533168</td>\n",
       "      <td>0.343659</td>\n",
       "      <td>0.057785</td>\n",
       "      <td>0.553024</td>\n",
       "      <td>0.198700</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>[3, 20, 41, 85, 160, 186, 172, 156, 124, 90, 6...</td>\n",
       "      <td>[3.0, 13.87, 28.69, 55.72, 97.06, 143.04, 172....</td>\n",
       "      <td>0.816578</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      alpha      beta        li        lo        l0   Zo   Z0  \\\n",
       "0  0.556824  0.432547  0.017546  0.455190  0.068463  1.0  1.0   \n",
       "1  0.917183  0.617733  0.110494  0.172180  0.323215  1.0  1.0   \n",
       "2  0.222595  0.684092  0.020499  0.309478  0.178384  1.0  1.0   \n",
       "3  0.513685  0.231400  0.054771  1.783674  0.630670  1.0  1.0   \n",
       "4  0.533168  0.343659  0.057785  0.553024  0.198700  1.0  1.0   \n",
       "\n",
       "                                                   i  \\\n",
       "0  [3, 13, 65, 134, 222, 229, 200, 153, 99, 69, 4...   \n",
       "1  [3, 3, 27, 71, 151, 170, 106, 63, 42, 20, 8, 4...   \n",
       "2  [3, 286, 527, 507, 413, 337, 273, 222, 172, 14...   \n",
       "3      [3, 4, 6, 2, 5, 8, 7, 13, 29, 44, 50, 67, 85]   \n",
       "4  [3, 20, 41, 85, 160, 186, 172, 156, 124, 90, 6...   \n",
       "\n",
       "                                                   I       tau  \n",
       "0  [3.0, 25.41, 66.24, 140.76, 212.17, 226.2, 190...  0.234051  \n",
       "1  [3.0, 46.43, 126.68, 188.65, 160.33, 101.22, 5...  0.403957  \n",
       "2  [3.0, 232.07, 521.39, 511.27, 423.76, 341.88, ...  0.231190  \n",
       "3  [3.0, 6.22, 8.89, 12.59, 17.59, 24.14, 32.47, ...  0.489115  \n",
       "4  [3.0, 13.87, 28.69, 55.72, 97.06, 143.04, 172....  0.816578  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print('SIRdata')\n",
    "data = SIRdata\n",
    "data.alpha_min,  data.alpha_max = 0.10, 0.90\n",
    "data.beta_min,   data.beta_max  = 0.25, 0.65\n",
    "print(data)\n",
    "print()\n",
    "\n",
    "datafile = '../data/SIR_traindata_100k.csv.gz'\n",
    "\n",
    "print('loading %s' % datafile)\n",
    "df = pd.read_csv(datafile)\n",
    "df['tau'] = np.random.uniform(0,1, len(df))\n",
    "print('number of rows:', len(df))\n",
    "\n",
    "df[:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "def plot_data(d, filename='../images/fig_SIR_flu_data.pdf', fgsize=(5, 4), ftsize=14):\n",
    "    \n",
    "    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=fgsize)\n",
    "    \n",
    "    # pad\n",
    "    #plt.subplots_adjust(hspace=0.01)\n",
    "    #plt.subplots_adjust(wspace=0.3)\n",
    "\n",
    "    #\n",
    "    xmin, xmax = 0,  18\n",
    "    ymin, ymax = 0, 400\n",
    "\n",
    "    ax.set_xlim(xmin, xmax)\n",
    "    ax.set_xlabel(r'$t$ (day)', fontsize=ftsize)\n",
    "    \n",
    "    ax.set_ylim(ymin, ymax)\n",
    "    ax.set_ylabel(r'infected (count)', fontsize=ftsize)\n",
    "    \n",
    "    ax.scatter(d.T, d.D, s=20, c='black', \n",
    "               label=r'number of individuals in class $I$')\n",
    "    ax.legend(fontsize=14)\n",
    "               \n",
    "    ax.grid() \n",
    "    \n",
    "    plt.tight_layout()\n",
    "    plt.savefig(filename)\n",
    "    print(filename)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "../images/fig_SIR_flu_data.pdf\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plot_data(SIRdata)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Train, validation, and test sets\n",
    "There is some confusion in terminology regarding validation and test samples (or sets). We shall adhere to the defintions given here https://machinelearningmastery.com/difference-test-validation-datasets/):\n",
    "   \n",
    "  * __Training Dataset__: The sample of data used to fit the model.\n",
    "  * __Validation Dataset__: The sample of data used to decide 1) whether the fit is reasonable (e.g., the model has not been overfitted), 2) decide which of several models is the best and 3) tune model hyperparameters.\n",
    "  * __Test Dataset__: The sample of data used to provide an unbiased evaluation of a final model fit on the training dataset.\n",
    "\n",
    "The validation set will be some small fraction of the training set and can be used, for example, to decide when to stop the training."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "train set size:         80000\n",
      "validation set size:     5000\n",
      "test set size:          15000\n",
      "    0\n",
      "saved to file: fig_hist_SIR_dnn_quantile.png\n"
     ]
    },
    {
     "data": {
      "image/png": "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DQ2lTp06HD9+HICtW7cyd+5cxowZQ+vWrR1D9dILYZGRkbRs2ZI9e/awbt061q5dy/79++nZsyfBwcGsWrWKcePGlSmXlJREhw4dHD8gHiMhAT75RHUKPvkELr0USi1qeQJt51kT6Nq18qvrOaeVB5GlCLpeB91ucG/bXEC2LGKHPEsgJgIxESRMBGEmyLYfRRCBouJ+wunTp2nevDlxcXEAjhXolStX0q1bN9q3V+lASs95CiHo3bs3N9xwA/fffz+vv/46W7Zs4fbbb6dFixYcOHCAqVOncuDAAaJttol9+/bl4YcfplOnTjRs6Jle/P3338+WLVvYsGEDq1evZvjw4fTooVxp09LS2L59O5deeqmjjSaTiVGjRjk+44IFCwgODqZXr15s3rwZgEsvvRQomQb4448/aNCgASGezlUkBIwfr1biR46E5GTo2VO5HdsWydyNFs/qyhNPKL9124JBpQkIVDEmI2OU54qXV9dzZTHp5JMu80u9FtCCcIab1SJGNkV8aN193joeNXWks6g4zUVoaCg33ngjmZmZjmMbN25k9erVzJkzh3o2rxe7oAghWLJkCcHBwQwfPpwXXniB9957j2nTphEREUFRURFPPPEEffr0ITo6msLCQoKCgigsLOS3337zmHDa6dy5M4WFhfTs2dNxTErJokWLeOqppzh69CgA8fHxzJgxg65duzp+KL766is6d+7MyJEjueuuu7j22msBHJ9p9+7dHD9+nJtvvvkvhvYA/PCsMt6v06TsFl7Xdd+rbt1g/XolpLNnw4gR8M03Kpq9m9HiWR1ZuFCF/AoKUrZxzZ0waA+pDcNfhMK8Ct393IVVStLJpx4hmG3/WG9btpMiz1R8vSgZRtcjmJ6iLsVYKcJKobS92vbDxPm/5qGhoURERHDkyBEA9u/fz8yZMxkxYgTdu3d3XGcXlJSUFObMmcMHH3yAlJKwsDBuu+02tm7dymWXXcbJkyf57bffeO+994CS4f6vv/7KVVdd5RAeTyGEcPSmSx+bMGECl112GbVr1+bMmTN0796doqIicnNzCQsL48MPP+TcuXO8+uqrmEwmVq9ezZtvvvmXzxQaGkrfilx8LcVwMLnicIUhteFvj6mgz64gMlLlTXrnHfj8cxg82DX1XgQtntWRubac508/7Zxw2jGZy6bYdTEWKTkbBqusJzkoczgg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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Fraction of the data assigned as test data and validation\n",
    "tfraction = 1.5/10 # test fraction, rest for training\n",
    "vfraction = 5/85\n",
    "tdata     = df\n",
    "\n",
    "SIRdata.alpha_bins = 10\n",
    "SIRdata.beta_bins  = 10\n",
    "\n",
    "# Split data into a part for training and a part for testing\n",
    "train_data, valid_data, test_data = ut.split_data(df, \n",
    "                                         test_fraction=tfraction, \n",
    "                                         validation_fraction=vfraction) \n",
    "\n",
    "print('train set size:        %6d' % train_data.shape[0])\n",
    "print('validation set size:   %6d' % valid_data.shape[0])\n",
    "print('test set size:         %6d' % test_data.shape[0])\n",
    "\n",
    "def smooth_hist(tfraction=2/3, K=1, d=SIRdata):\n",
    "    P = np.zeros((data.alpha_bins, d.beta_bins))\n",
    "    for k in range(K):\n",
    "        print('\\r%5d' % k, end='')\n",
    "        _, test   = train_test_split(df, \n",
    "                                 test_size=tfraction, \n",
    "                                 shuffle=True)\n",
    "        p, xe, ye = ut.hist_data(test, SIRdata)\n",
    "        P += p\n",
    "    print()\n",
    "    P /= K\n",
    "    return P, xe, ye\n",
    "\n",
    "hist = smooth_hist()\n",
    "\n",
    "ut.plot_model(tdata, SIRdata, \n",
    "              filename='fig_hist_%s.png' % NN.name)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Empirical risk (that is, average loss)\n",
    "\n",
    "The empirical risk, which is the __objective function__ we shall minimize, is defined by\n",
    "\n",
    "\\begin{align}\n",
    "R_M(\\theta) & = \\frac{1}{M} \\sum_{m=1}^{M} L(t_m, f_m),\n",
    "\\end{align}\n",
    "\n",
    "where \n",
    "\n",
    "\\begin{align*}\n",
    "    f_m & \\equiv f(\\mathbf{x}_m, \\theta).\n",
    "\\end{align*}\n",
    "\n",
    "The empirical risk $R_M$ approximates the __risk functional__\n",
    "\n",
    "\\begin{align}\n",
    "R[f] & = \\int \\cdots \\int \\, p(t, \\mathbf{x}) \\, L(t, f(\\mathbf{x}, \\theta)) \\, dt \\, d\\mathbf{x} .\n",
    "\\end{align}\n",
    "\n",
    "The quantity $p(t, \\mathbf{x}) \\, dt\\, d\\mathbf{x}$ is the probability distribution from which the sample $\\{ (t_m, \\mathbf{x}_m), m = 1,\\cdots, M \\}$ is presumed to have been drawn. \n",
    "\n",
    "We use the __quadratic loss__\n",
    "\n",
    "$$\n",
    "    \\ell_{\\tau}(y, \\hat{y}) \\begin{align}\n",
    "    &=\n",
    "    \\begin{cases}\n",
    "        \\tau (y - \\hat{y} ), \\qquad & \\text{if } y> \\hat{y} \\\\\n",
    "         (1-\\tau) (\\hat{y}-y), \\qquad &\\text{otherwise}\n",
    "    \\end{cases}\n",
    "    \\end{align}\n",
    "$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Train!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "traces = ([], [], [])\n",
    "traces_step = 100\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "        \n",
    "def train(model, optimizer, dictfile, early_stopping_count,\n",
    "          avloss, getbatch,\n",
    "          train_data, valid_data, \n",
    "          features, target,\n",
    "          batch_size,\n",
    "          n_iterations, \n",
    "          traces, \n",
    "          step=10):\n",
    "    \n",
    "    #model.to(device)\n",
    "    \n",
    "    train_x, train_t = split_source_target(train_data, \n",
    "                                           features, target)\n",
    "    \n",
    "    valid_x, valid_t = split_source_target(valid_data, \n",
    "                                           features, target)\n",
    "    \n",
    "    # to keep track of average losses\n",
    "    xx, yy_t, yy_v = traces\n",
    "    \n",
    "    # save model with smallest validation loss\n",
    "    # if after early_stopping_count iterations \n",
    "    # no validation scores are lower than the\n",
    "    # current lowest value.\n",
    "    min_acc_v = 1.e30\n",
    "    stopping_count = 0\n",
    "    jjsaved = 0\n",
    "    \n",
    "    n = len(valid_x)\n",
    "    \n",
    "    print('Iteration vs average loss')\n",
    "    print(\"%9s %9s %9s\" % \\\n",
    "          ('iteration', 'train-set', 'valid-set'))\n",
    "    \n",
    "    for ii in range(n_iterations):\n",
    "                \n",
    "        stopping_count += 1\n",
    "            \n",
    "        # set mode to training so that training specific \n",
    "        # operations such as dropout are enabled.\n",
    "        model.train()\n",
    "        \n",
    "        # get a random sample (a batch) of data (as numpy arrays)\n",
    "        batch_x, batch_t = getbatch(train_x, train_t, batch_size)\n",
    "        \n",
    "        # convert the numpy arrays batch_x and batch_t to tensor \n",
    "        # types. The PyTorch tensor type is the magic that permits \n",
    "        # automatic differentiation with respect to parameters. \n",
    "        # However, since we do not need to take the derivatives\n",
    "        # with respect to x and t, we disable this feature\n",
    "        with torch.no_grad(): # no need to compute gradients \n",
    "            # wrt. x and t\n",
    "            x = torch.from_numpy(batch_x).float()#.to(device)\n",
    "            t = torch.from_numpy(batch_t).float()#.to(device)\n",
    "            #x.to(device)\n",
    "            #t.to(device)\n",
    "            \n",
    "        # compute the output of the model for the batch of data x\n",
    "        # Note: outputs is \n",
    "        #   of shape (-1, 1), but the tensor targets, t, is\n",
    "        #   of shape (-1,)\n",
    "        # In order for the tensor operations with outputs and t\n",
    "        # to work correctly, it is necessary that they have the\n",
    "        # same shape. We can do this with the reshape method.\n",
    "        outputs = model(x).reshape(t.shape)#.to(device)\n",
    "        #outputs.to(device)\n",
    "        \n",
    "        # compute a noisy approximation to the average loss\n",
    "        empirical_risk = avloss(outputs, t, x)\n",
    "        \n",
    "        # use automatic differentiation to compute a \n",
    "        # noisy approximation of the local gradient\n",
    "        optimizer.zero_grad()       # clear previous gradients\n",
    "        empirical_risk.backward()   # compute gradients\n",
    "        \n",
    "        # finally, advance one step in the direction of steepest \n",
    "        # descent, using the noisy local gradient. \n",
    "        optimizer.step()            # move one step\n",
    "        acc_t = validate(model, avloss, train_x[:n], train_t[:n]) \n",
    "        \n",
    "        if ii % step == 0:\n",
    "            \n",
    "            acc_t = validate(model, avloss, train_x[:n], train_t[:n]) \n",
    "            acc_v = validate(model, avloss, valid_x[:n], valid_t[:n])\n",
    "            \n",
    "            if acc_v < min_acc_v:\n",
    "                min_acc_v = acc_v\n",
    "                torch.save(model.state_dict(), dictfile)\n",
    "                stopping_count = 0\n",
    "                jjsaved = ii\n",
    "            else:\n",
    "                if stopping_count > early_stopping_count:\n",
    "                    print('\\n\\nstopping early!')\n",
    "                    break\n",
    "                    \n",
    "            if len(xx) < 1:\n",
    "                xx.append(0)\n",
    "                print(\"%9d %9.7f %9.7f\" % (xx[-1], acc_t, acc_v))\n",
    "            elif len(xx) < 5:\n",
    "                xx.append(xx[-1] + step)\n",
    "                print(\"%9d %9.7f %9.7f\" % (xx[-1], acc_t, acc_v))\n",
    "            else:\n",
    "                xx.append(xx[-1] + step)\n",
    "                saved = ' %9d: %9d/%10.8f/%9d' % \\\n",
    "                (ii, jjsaved, min_acc_v, stopping_count)\n",
    "                print(\"\\r%9d %9.7f %9.7f%s\" % \\\n",
    "                      (xx[-1], acc_t, acc_v, saved), end='')\n",
    "                \n",
    "            yy_t.append(acc_t)\n",
    "            yy_v.append(acc_v)\n",
    "                \n",
    "    print()\n",
    "    \n",
    "    model.load_state_dict(torch.load(dictfile))\n",
    "    return (xx, yy_t, yy_v)\n",
    "\n",
    "def split_source_target(df, source, target):\n",
    "    # change from pandas dataframe format to a numpy \n",
    "    # array of the specified types\n",
    "    x = np.array(df[source])\n",
    "    t = np.array(df[target])\n",
    "    return x, t"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'traces' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m/tmp/ipykernel_2281/3939368715.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     15\u001b[0m                   \u001b[0mn_batch\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     16\u001b[0m                   \u001b[0mn_iterations\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 17\u001b[0;31m                   \u001b[0mtraces\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     18\u001b[0m                   step=traces_step)\n",
      "\u001b[0;31mNameError\u001b[0m: name 'traces' is not defined"
     ]
    }
   ],
   "source": [
    "n_batch       = 50\n",
    "n_iterations  = 50000\n",
    "early_stopping= 2000\n",
    "learning_rate = 1.e-3\n",
    "\n",
    "optimizer     = torch.optim.Adam(model.parameters(), \n",
    "                                 lr=learning_rate) \n",
    "\n",
    "traces = ut.train(model, optimizer, \n",
    "                  modelfile, early_stopping,\n",
    "                  ut.average_quantile_loss,\n",
    "                  ut.get_batch, \n",
    "                  train_data, valid_data,\n",
    "                  features, target,\n",
    "                  n_batch, \n",
    "                  n_iterations,\n",
    "                  traces,\n",
    "                  step=traces_step)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Iteration vs average loss\n",
      "iteration train-set valid-set\n"
     ]
    },
    {
     "ename": "TypeError",
     "evalue": "cannot unpack non-iterable NoneType object",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m/tmp/ipykernel_409/538087474.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     23\u001b[0m \u001b[0mlearning_rate\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;36m1.e-4\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     24\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 25\u001b[0;31m traces = train(model, optimizer, \n\u001b[0m\u001b[1;32m     26\u001b[0m                   \u001b[0mmodelfile\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mearly_stopping\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     27\u001b[0m                   \u001b[0mut\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0maverage_quantile_loss\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/tmp/ipykernel_409/146901967.py\u001b[0m in \u001b[0;36mtrain\u001b[0;34m(model, optimizer, dictfile, early_stopping_count, avloss, getbatch, train_data, valid_data, features, target, batch_size, n_iterations, traces, step)\u001b[0m\n\u001b[1;32m     17\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     18\u001b[0m     \u001b[0;31m# to keep track of average losses\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 19\u001b[0;31m     \u001b[0mxx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0myy_t\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0myy_v\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtraces\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     20\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     21\u001b[0m     \u001b[0;31m# save model with smallest validation loss\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mTypeError\u001b[0m: cannot unpack non-iterable NoneType object"
     ]
    }
   ],
   "source": [
    "n_batch       = 50\n",
    "n_iterations  = 50000\n",
    "early_stopping= 2000\n",
    "learning_rate = 1.e-3\n",
    "\n",
    "optimizer     = torch.optim.Adam(model.parameters(), \n",
    "                                 lr=learning_rate) \n",
    "\n",
    "traces = train(model, optimizer, \n",
    "                  modelfile, early_stopping,\n",
    "                  ut.average_quantile_loss,\n",
    "                  ut.get_batch, \n",
    "                  train_data, valid_data,\n",
    "                  features, target,\n",
    "                  n_batch, \n",
    "                  n_iterations,\n",
    "                  traces,\n",
    "                  step=traces_step)\n",
    "\n",
    "n_batch       = 500\n",
    "n_iterations  = 50000\n",
    "early_stopping= 2000\n",
    "learning_rate = 1.e-4\n",
    "\n",
    "traces = train(model, optimizer, \n",
    "                  modelfile, early_stopping,\n",
    "                  ut.average_quantile_loss,\n",
    "                  ut.get_batch, \n",
    "                  train_data, valid_data,\n",
    "                  features, target,\n",
    "                  n_batch, \n",
    "                  n_iterations,\n",
    "                  traces,\n",
    "                  step=traces_step)\n",
    "\n",
    "ut.plot_average_loss(traces)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Plot results of trained model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "import SIR_gen_util as gt\n",
    "importlib.reload(gt)\n",
    "\n",
    "def dnn(x, y, d, f=model):\n",
    "    l = np.array(gt.test_statistic(x, y, d))\n",
    "    I = np.array([l, x, y]).T\n",
    "    X = torch.Tensor(I)\n",
    "    \n",
    "    # go to evaluation mode\n",
    "    model.eval()\n",
    "    \n",
    "    # compute,reshape to a 1d array, and convert to a numpy array\n",
    "    Y = model(X).view(-1,).detach().numpy()\n",
    "    if len(Y) == 1:\n",
    "        return Y[0]\n",
    "    else:\n",
    "        return Y"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "load model: SIR_dnn_quantile.dict\n"
     ]
    }
   ],
   "source": [
    "Load_model = True\n",
    "print('load model: %s' % modelfile)\n",
    "\n",
    "if Load_model:\n",
    "    modeldict = torch.load(modelfile)\n",
    "    NN.model.load_state_dict(modeldict)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "device: cpu\n",
      "alpha:      0.396, beta:      0.210*5.0e-03, min(fun):      0.111\n",
      "                   beta:      0.00105\n",
      "saved to file: ../images/fig_SIR_dnn_quantile.pdf\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import SIR_dnn_util as ut\n",
    "importlib.reload(ut)\n",
    "\n",
    "SIRdata.O = SIRdata.D\n",
    "res = ut.best_fit(ut.nll, dnn, SIRdata)\n",
    "\n",
    "ut.plot_model(test_data, SIRdata, dnn, res, hist=hist,\n",
    "              filename='../images/fig_%s.pdf' % NN.name)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "def cdf(x, y, z):\n",
    "    X = np.array([x, y, z]).T\n",
    "    inputs = torch.Tensor(X)\n",
    "    # go to evaluation mode\n",
    "    model.eval()\n",
    "    \n",
    "    # compute,reshape to a 1d array, and convert to a numpy array\n",
    "    Y = model(inputs).view(-1,).detach().numpy()\n",
    "    if len(Y) == 1:\n",
    "        return Y[0]\n",
    "    else:\n",
    "        return Y"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "13632"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "select = cdf(test_data.alpha, test_data.beta, test_data.l0) <= 0.95\n",
    "CL95   = test_data[['alpha', 'beta', 'i']][select]\n",
    "CL95.to_csv('../data/SIR_CL95.csv.gz', index=False, compression='gzip')\n",
    "len(CL95)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "@webio": {
   "lastCommId": null,
   "lastKernelId": null
  },
  "accelerator": "GPU",
  "colab": {
   "collapsed_sections": [],
   "name": "DRL_19_REINFORCE_Algorithm.ipynb",
   "provenance": []
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
